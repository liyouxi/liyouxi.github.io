<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Ups and Downs</title><link href="http://liyouxi.github.io/" rel="alternate"></link><link href="http://liyouxi.github.io/feeds/edx.atom.xml" rel="self"></link><id>http://liyouxi.github.io/</id><updated>2016-06-01T00:00:00+08:00</updated><entry><title>Insight Analytics Task 常见问题</title><link href="http://liyouxi.github.io/edx_11.html" rel="alternate"></link><published>2016-06-01T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-06-01:edx_11.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;Insight Analytics Task 常见问题&lt;/h2&gt;
&lt;h3&gt;ImportEnrollmentsIntoMysql&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;1、错误提示：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql.png" /&gt;&lt;/p&gt;
&lt;p&gt;问题分析：&lt;/p&gt;
&lt;p&gt;manifest input_format 错误。&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/var/lib/analytics-tasks/analyticstack/repo/override.cfg
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;修改&lt;code&gt;override.cfg&lt;/code&gt;如下配置：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;[manifest]&lt;/span&gt;
&lt;span class="na"&gt;input_format&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;org.edx.hadoop.input.ManifestTextInputFormat&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;2、错误提示&lt;/strong&gt;
&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql1.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql2.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql3.png" /&gt;&lt;/p&gt;
&lt;p&gt;问题分析：&lt;/p&gt;
&lt;p&gt;数据库链接错误&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;p&gt;修改&lt;code&gt;/edx/etc/edx-analytics-pipeline/input.json&lt;/code&gt;中参数&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3、错误提示&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql4.1.png" /&gt;
&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql4.1.png" /&gt;&lt;/p&gt;
&lt;p&gt;错误分析：&lt;/p&gt;
&lt;p&gt;重跑任务冲突&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;p&gt;1、清理数据&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql4.2.1.png" /&gt;
&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql4.2.2.png" /&gt;&lt;/p&gt;
&lt;p&gt;2、修改任务结束时间&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4、错误提示&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/ImportEnrollmentsIntoMysql5.png" /&gt;&lt;/p&gt;
&lt;p&gt;错误分析：&lt;/p&gt;
&lt;p&gt;无法连接&lt;code&gt;LMS database&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;p&gt;注释&lt;code&gt;/etc/mysql/my.cnf&lt;/code&gt;中的 &lt;code&gt;bind-address = 127.0.0.1&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;InsertToMysqlAllVideoTask&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;1、错误提示&lt;/strong&gt;
&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/InsertToMysqlAllVideoTask1.png" /&gt;&lt;/p&gt;
&lt;p&gt;问题分析：&lt;/p&gt;
&lt;p&gt;没有使&lt;code&gt;video tab&lt;/code&gt;在&lt;code&gt;Insights&lt;/code&gt;中可用&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;p&gt;使如下&lt;code&gt;tab&lt;/code&gt;可用:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;enable_engagement_videos_pages
enable_course_api
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;2、错误提示&lt;/strong&gt;
&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/InsertToMysqlAllVideoTask.png" /&gt;&lt;/p&gt;
&lt;p&gt;问题分析：&lt;/p&gt;
&lt;p&gt;没有在&lt;code&gt;insights_env&lt;/code&gt;下运行改命令&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;source /edx/app/insights/insights_env
source /edx/app/insights/venvs/insights/bin/activate
cd /edx/app/insights/edx_analytics_dashboard
./manage.py switch enable_course_api on --create
./manage.py switch enable_video_preview on --create
./manage.py switch enable_engagement_videos_pages on --create
deactivate
sudo -u insights nano /edx/etc/insights.yml (correct all urls)
sudo /edx/bin/supervisorctl restart all
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;AnswerDistributionWorkflow&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;错误提示&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/AnswerDistributionWorkflow.png" /&gt;&lt;/p&gt;
&lt;p&gt;错误分析：&lt;/p&gt;
&lt;p&gt;Hadoop内存限制&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;/edx/app/hadoop/hadoop-2.3.0/etc/hadoop/yarn-site.xml&lt;/code&gt; 中添加一下属性：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;property&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;name&amp;gt;&lt;/span&gt;yarn.nodemanager.vmem-check-enabled&lt;span class="nt"&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;value&amp;gt;&lt;/span&gt;false&lt;span class="nt"&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Whether virtual memory limits will be enforced for containers&lt;span class="nt"&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;property&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;name&amp;gt;&lt;/span&gt;yarn.nodemanager.vmem-pmem-ratio&lt;span class="nt"&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;value&amp;gt;&lt;/span&gt;4&lt;span class="nt"&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;InsertToMysqlCourseEnrollByCountryWorkflow&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;1、错误提示&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;问题所在位置&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="x"&gt;--user-country-output &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;INTERMEDIATE_OUTPUT_ROOT&lt;/span&gt;&lt;span class="x"&gt;/&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;END_DATE&lt;/span&gt;&lt;span class="x"&gt;/user_location --course-country-output &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;INTERMEDIATE_OUTPUT_ROOT&lt;/span&gt;&lt;span class="x"&gt;/&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;END_DATE&lt;/span&gt;&lt;span class="x"&gt;/country_course&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;问题分析：&lt;/p&gt;
&lt;p&gt;这些变量的路径指向为空&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;p&gt;需要下载一个国家ip库并放到cfg中定义的hdfs目录
&lt;a href="http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz"&gt;http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;错误提示&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://o84fct7cn.bkt.clouddn.com/InsertToMysqlCourseEnrollByCountryWorkflow.png" /&gt;&lt;/p&gt;
&lt;p&gt;错误分析：&lt;/p&gt;
&lt;p&gt;因为有某些用户的位置是NULL&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/var/lib/analytics-tasks/analyticstack/repo/edx/analytics/tasks# 
vim location_per_course.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;删除py代码中的NOT NULL&lt;/p&gt;
&lt;p&gt;修改数据表&lt;code&gt;[reports] course_enrollment_location_current&lt;/code&gt;的字段定义&lt;/p&gt;</summary><category term="edx"></category></entry><entry><title>edx开启课程搜索功能</title><link href="http://liyouxi.github.io/edx_10.html" rel="alternate"></link><published>2016-05-12T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-05-12:edx_10.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;edx开启课程搜索功能&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;启用特性： 在&lt;code&gt;*.env.json&lt;/code&gt;中&lt;code&gt;FEATURES&lt;/code&gt;里加上 &lt;code&gt;"ENABLE_COURSEWARE_INDEX": true,&lt;/code&gt; 和&lt;code&gt;"ENABLE_LIBRARY_INDEX": true,&lt;/code&gt;,如果加上&lt;code&gt;"ENABLE_COURSE_DISCOVERY": true,&lt;/code&gt;那么首页的搜索功能也将被开启.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在Studio里， 点击Reindex， 索引完成即可搜索，搜索基于elasticsearch
在devstack中默认搜索功能，如果需要在生产环境里使用，可以参考devstack.py&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;cd /edx/app/edxapp/edx-platform/lms/envs&lt;/code&gt;    将以下代码复制到&lt;code&gt;aws.py&lt;/code&gt;最后，该代码来自devstack.py&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;########################## Course Discovery #######################
_ = lambda s: s
LANGUAGE_MAP = {&amp;#39;terms&amp;#39;: {lang: display for lang, display in ALL_LANGUAGES}, &amp;#39;name&amp;#39;: _(&amp;#39;Language&amp;#39;)}
COURSE_DISCOVERY_MEANINGS = {
&amp;#39;org&amp;#39;: {
    &amp;#39;name&amp;#39;: _(&amp;#39;Organization&amp;#39;),
},
&amp;#39;modes&amp;#39;: {
    &amp;#39;name&amp;#39;: _(&amp;#39;Course Type&amp;#39;),
    &amp;#39;terms&amp;#39;: {
        &amp;#39;honor&amp;#39;: _(&amp;#39;Honor&amp;#39;),
        &amp;#39;verified&amp;#39;: _(&amp;#39;Verified&amp;#39;),
    },
},
&amp;#39;language&amp;#39;: LANGUAGE_MAP,
}

FEATURES[&amp;#39;ENABLE_COURSE_DISCOVERY&amp;#39;] = True
# Setting for overriding default filtering facets for Course discovery
# COURSE_DISCOVERY_FILTERS = [&amp;quot;org&amp;quot;, &amp;quot;language&amp;quot;, &amp;quot;modes&amp;quot;]
FEATURES[&amp;#39;COURSES_ARE_BROWSEABLE&amp;#39;] = True
HOMEPAGE_COURSE_MAX = 9

# Software secure fake page feature flag
FEATURES[&amp;#39;ENABLE_SOFTWARE_SECURE_FAKE&amp;#39;] = True

# Setting for the testing of Software Secure Result Callback
VERIFY_STUDENT[&amp;quot;SOFTWARE_SECURE&amp;quot;] = {
    &amp;quot;API_ACCESS_KEY&amp;quot;: &amp;quot;BBBBBBBBBBBBBBBBBBBB&amp;quot;,
    &amp;quot;API_SECRET_KEY&amp;quot;: &amp;quot;CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC&amp;quot;,
}

# Skip enrollment start date filtering
SEARCH_SKIP_ENROLLMENT_START_DATE_FILTERING = True
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;参考文献&lt;/strong&gt;：&lt;a href="http://edx.readthedocs.io/projects/edx-installing-configuring-and-running/en/latest/configuration/edx_search.html#install-edx-search"&gt;http://edx.readthedocs.io/projects/edx-installing-configuring-and-running/en/latest/configuration/edx_search.html#install-edx-search&lt;/a&gt;&lt;/p&gt;</summary><category term="edx"></category></entry><entry><title>edx启用支付功能</title><link href="http://liyouxi.github.io/edx_8.html" rel="alternate"></link><published>2016-05-12T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-05-12:edx_8.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;edx启用支付功能&lt;/h2&gt;
&lt;h3&gt;1、修改配置文件&lt;/h3&gt;
&lt;p&gt;在lms.env.json添加如下代码：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;...
&amp;quot;FEATURES&amp;quot;: {
...
&amp;quot;ENABLE_SHOPPING_CART&amp;quot;: true,
&amp;quot;ENABLE_PAID_COURSE_REGISTRATION&amp;quot;: true,
...
}
....
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;在lms.auth.json添加如下代码：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;...
&amp;quot;CC_PROCESSOR&amp;quot;: {
    &amp;quot;CyberSource2&amp;quot;: {
        &amp;quot;ACCESS_KEY&amp;quot;: &amp;quot;{fill in with access key provided by CyberSource}&amp;quot;, 
        &amp;quot;PROFILE_ID&amp;quot;: &amp;quot;{fill in with profile id provided by CyberSource}&amp;quot;, 
        &amp;quot;PURCHASE_ENDPOINT&amp;quot;: &amp;quot;{fill in with endpoint url provided by CyberSource}&amp;quot;, 
        &amp;quot;SECRET_KEY&amp;quot;: &amp;quot;{fill in with secret key provided by CyberSource}&amp;quot;
    }
}, 
&amp;quot;CC_PROCESSOR_NAME&amp;quot;: &amp;quot;CyberSource2&amp;quot;,
...
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;2、添加 course mode&lt;/h3&gt;
&lt;p&gt;登录django后台，找到&lt;code&gt;Course modes&lt;/code&gt;然后点击&lt;code&gt;Add course mode&lt;/code&gt;添加相关信息，具体如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Course id: 相关联课程ID， 格式为"{org}/{course}/{run}"， 例如 "foo/bar/baz"。&lt;/li&gt;
&lt;li&gt;Mode slug: 设置为 "honor"。&lt;/li&gt;
&lt;li&gt;Mode display name: 建议设置为"Honor Code"。&lt;/li&gt;
&lt;li&gt;Min Price: 课程最低价格。&lt;/li&gt;
&lt;li&gt;Currency: 价格单位 "usd" (US 美元). 也可以输入其他的 (列如 'chf' 为 瑞士法郎).&lt;/li&gt;
&lt;li&gt;Expiration Date/Date Time. 到期时间，推荐不填。&lt;/li&gt;
&lt;/ol&gt;</summary><category term="edx"></category></entry><entry><title>Dogwood添加主题</title><link href="http://liyouxi.github.io/edx_9.html" rel="alternate"></link><published>2016-05-12T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-05-12:edx_9.html</id><summary type="html">&lt;hr /&gt;
&lt;h3&gt;1.克隆主题源代码并修改权限&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cd /edx/app/edxapp
mkdir themes
cd themes
sudo git clone -b https://github.com/******/edx-theme
mv edx-theme my_theme
cd appsembler-dogwood/static/sass/
mv _default.scss  _my_theme.scss
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;2. 修改lms.env.json:&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo vi /edx/app/edxapp/lms.env.json
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;修改对应值:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&amp;quot;USE_CUSTOM_THEME&amp;quot;: true
&amp;quot;THEME_NAME&amp;quot;: &amp;quot;******&amp;quot;,
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;3.编译静态文件&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo -H -u edxapp bash
source /edx/app/edxapp/edxapp_env
cd /edx/app/edxapp/edx-platform
paver update_assets lms --settings aws
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;4.重启edxapp&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo /edx/bin/supervisorctl restart edxapp:
&lt;/pre&gt;&lt;/div&gt;</summary><category term="edx"></category></entry><entry><title>配置使用MICROSITE</title><link href="http://liyouxi.github.io/edx_7.html" rel="alternate"></link><published>2016-05-09T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-05-09:edx_7.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;配置使用MICROSITE&lt;/h2&gt;
&lt;h3&gt;1、域名泛解析到服务器&lt;/h3&gt;
&lt;h3&gt;2、开启MICROSITE&lt;/h3&gt;
&lt;p&gt;修改：&lt;code&gt;lms/envs/common.py&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;vi /edx/app/edxapp/edx-platform/lms/envs/common.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;修改：&lt;code&gt;'USE_MICROSITES': True,&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;3、配置：&lt;/h3&gt;
&lt;p&gt;修改 &lt;code&gt;lms.env.json&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&amp;quot;MICROSITE\_CONFIGURATION&amp;quot;: {
&amp;quot;test1&amp;quot;: {
&amp;quot;domain_prefix&amp;quot;: &amp;quot;test1&amp;quot;,
&amp;quot;university&amp;quot;: &amp;quot;test1&amp;quot;,
&amp;quot;SITE_NAME&amp;quot;: &amp;quot;sitename&amp;quot;,
&amp;quot;logo_image_url&amp;quot;: &amp;quot;http://******/logo.png&amp;quot;,
&amp;quot;course_org_filter&amp;quot;: &amp;quot;test1&amp;quot;,
&amp;quot;course_about_show_social_links&amp;quot;: false
}
},
&amp;quot;MICROSITE_ROOT_DIR&amp;quot;: &amp;quot;/edx/app/edxapp/edx-microsite&amp;quot;,
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;修改__init__.py文件&lt;/p&gt;
&lt;p&gt;edx-platform/lms/djangoapps/branding/__init__.py&lt;/p&gt;
&lt;p&gt;删除66行的&lt;code&gt;{static_url}&lt;/code&gt;和67行&lt;code&gt;static_url=settings.STATIC_URL&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;重启edxapp,编译lms生效&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo -H -u edxapp bash  
source /edx/app/edxapp/edxapp_env
cd /edx/app/edxapp/edx-platform
paver update_assets lms --settings aws
exit

sudo /edx/bin/supervisorctl restart edxapp:
&lt;/pre&gt;&lt;/div&gt;</summary><category term="edx"></category></entry><entry><title>课程转移字幕问题解决方案</title><link href="http://liyouxi.github.io/edx_5.html" rel="alternate"></link><published>2016-05-05T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-05-05:edx_5.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;课程转移字幕问题解决方案&lt;/h2&gt;
&lt;p&gt;在Cypress版中字幕的默认格式为&lt;code&gt;table&lt;/code&gt;，将Cypress版中导出的课程再导入到Dogwood版中时会发现字幕无法显示，是因为Dogwood版中字幕格式没有&lt;code&gt;table&lt;/code&gt;这个字段。&lt;/p&gt;
&lt;h3&gt;解决方案&lt;/h3&gt;
&lt;p&gt;解压导出的课程文件会发现字幕字段是由video目录下的文件中控制的，因此只需要将video下文件中的&lt;code&gt;table&lt;/code&gt;字段替换成&lt;code&gt;zh&lt;/code&gt;就行。替换命令&lt;code&gt;find ./ -type f -print0 | xargs -0 sed 's/table/zh/g'&lt;/code&gt;&lt;/p&gt;</summary><category term="edx"></category></entry><entry><title>insight-启用dashboard标签</title><link href="http://liyouxi.github.io/edx_6.html" rel="alternate"></link><published>2016-05-05T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-05-05:edx_6.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;insight-启用dashboard上标签&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;source /edx/app/insights/insights_env
source /edx/app/insights/venvs/insights/bin/activate
cd /edx/app/insights/edx_analytics_dashboard
./manage.py switch enable_course_api on --create
./manage.py switch enable_video_preview on --create
./manage.py switch enable_engagement_videos_pages on --create
deactivate
sudo -u insights nano /edx/etc/insights.yml (correct all urls)
sudo /edx/bin/supervisorctl restart all
&lt;/pre&gt;&lt;/div&gt;</summary><category term="edx"></category></entry><entry><title>insight 分析开发介绍</title><link href="http://liyouxi.github.io/edx_4.html" rel="alternate"></link><published>2016-04-27T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-04-27:edx_4.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;insight 分析开发介绍&lt;/h2&gt;
&lt;h3&gt;关于Analytics&lt;/h3&gt;
&lt;p&gt;Analytics的架构图，来自2015 Open edX Conference
&lt;img alt="insight" src="http://7xofqa.com1.z0.glb.clouddn.com/Architecture%20diagram.png" /&gt;&lt;/p&gt;
&lt;h3&gt;常见问题&lt;/h3&gt;
&lt;h4&gt;Pipeline是什么?&lt;/h4&gt;
&lt;p&gt;Pipeline是批处理数据处理引擎。它读取各种EDX服务产生的原始数据量大，分析它产生有用的报告。并将分析结果存储在MySQL数据库，详细信息请看analytics data api。&lt;/p&gt;
&lt;p&gt;该Pipeline的代码在GitHub库中的&lt;a href="https://github.com/edx/edx-analytics-pipeline"&gt;edx-analytics-pipeline&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;它是一个有效的工作流引擎，通过各种各样的数据处理技术来执行，目前主要使用的Python，Hadoop、Hive和Sqoop。&lt;/p&gt;
&lt;h4&gt;Insights是什么?&lt;/h4&gt;
&lt;p&gt;Insights是Open edX的重要特性之一，它可以对学习数据进行数据分析，并将分析结果展现出来。&lt;/p&gt;
&lt;h4&gt;Insights可以运行，但无法登陆的解决方案&lt;/h4&gt;
&lt;p&gt;可能是oauth2没设置好导致这个错误，请参考&lt;a href="https://openedx.atlassian.net/wiki/display/AN/Configuring+Insights+for+Open+ID+Connect+SSO+with+LMS"&gt;Configuring Insights for Open ID Connect SSO with LMS &lt;/a&gt;。&lt;/p&gt;
&lt;h4&gt;问题咨询途径?&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://openedx.slack.com"&gt;Analytics Open edX slack channel&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://groups.google.com/forum/#!forum/openedx-analytics"&gt;openedx-analytics&lt;/a&gt; google group&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;安装配置连接&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://openedx.atlassian.net/wiki/display/OpenOPS/edX+Analytics+Installation"&gt;edX Analytics Installation&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://edx.readthedocs.org/projects/edx-installing-configuring-and-running/en/latest/analytics/install_analytics.html#options-for-installing-edx-insights"&gt;Options for Installing edX Insights&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary><category term="edx insight"></category></entry><entry><title>insight 配置</title><link href="http://liyouxi.github.io/edx_3.html" rel="alternate"></link><published>2016-04-21T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-04-21:edx_3.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;insight配置&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;insight的主要配置文件如下：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;/edx/etc/下面&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;analytics_api.yml&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;insight.yml&lt;/p&gt;
&lt;p&gt;CMS_COURSE_SHORTCUT_BASE_URL: http://www.edx.com/course&lt;/p&gt;
&lt;p&gt;COURSE_API_URL: http://www.edx.com/api/course_structure/v0/&lt;/p&gt;
&lt;p&gt;MODULE_PREVIEW_URL: http://www.edx.com/xblock&lt;/p&gt;
&lt;p&gt;SOCIAL_AUTH_EDX_OIDC_URL_ROOT: http://www.edx.com/oauth2&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;edx-analytics-pipeline/input.json  //这里设置成LMS机器上的数据库信息&lt;/p&gt;
&lt;p&gt;{"username": "localhost", "host": "localhost", "password": "password", "port": 3306}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;edx-analytics-pipeline/output.json&lt;/p&gt;
&lt;p&gt;{"username": "pipeline001", "host": "localhost", "password": "password","port":3306}&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;/var/lib/analytics-tasks/analyticstack/repo/override.cfg&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;~/edx-analytic-pipline/config/下面&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;devstack.cfg      &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;local.cfg     &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;test.cfg&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary><category term="edx insight"></category></entry><entry><title>edx主要数据</title><link href="http://liyouxi.github.io/edx_2.html" rel="alternate"></link><published>2016-04-08T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-04-08:edx_2.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;edx相关数据&lt;/h2&gt;
&lt;h3&gt;视频行为数据&lt;/h3&gt;
&lt;p&gt;日志文件的地址：&lt;code&gt;/edx/var/log/tracking&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;包含的视频操作事件有：前者为浏览器触发事件名称，后者为移动端触发事件名称&lt;/p&gt;
&lt;p&gt;&lt;code&gt;hide_transcript/edx.video.transcript.hidden&lt;/code&gt;    //当用户选择CC抑制显示视频记录,浏览器或移动应用程序发出该事件。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;load_video/edx.video.loaded&lt;/code&gt;   //当视频完全加载完,准备开始,浏览器或移动应用程序发出该
事件&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pause_video/edx.video.paused，stop_video/edx.video.stopped&lt;/code&gt;//当用户选择视频播放器的暂停控制,发出&lt;code&gt;pause_video&lt;/code&gt;事件。流的视频在浏览器上,当播放的视频文件时自动停止它释放这个事件和&lt;code&gt;stop_video&lt;/code&gt;事件&lt;/p&gt;
&lt;p&gt;&lt;code&gt;play_video/edx.video.played&lt;/code&gt;  //当用户选择播放视频时,发出&lt;code&gt;play_video&lt;/code&gt;事件。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;seek_video/edx.video.position.changed&lt;/code&gt;   //浏览器发出seek_video事件当用户选择不同位置播放视频文件时。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;show_transcript/edx.video.transcript.shown&lt;/code&gt;  //用户选择显示视频字幕文件时触发该事件&lt;/p&gt;
&lt;p&gt;&lt;code&gt;speed_change_video&lt;/code&gt;    //当用户在浏览器选择不同的视频播放速度时触发该事件。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;video_hide_cc_menu&lt;/code&gt;   //隐藏CC菜单时触发&lt;/p&gt;
&lt;p&gt;&lt;code&gt;video_show_cc_menu&lt;/code&gt;   //显示CC菜单时触发&lt;/p&gt;
&lt;h4&gt;数据记录例子&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;{ "_id" : { "$oid" : "564a891b7f437b04c805d11e" }, &lt;/p&gt;
&lt;p&gt;"username" : "XXX",    //用户名&lt;/p&gt;
&lt;p&gt;"context" : &lt;/p&gt;
&lt;p&gt;{ "course_id" : "course-v1:XXXX+XS100+2016_T1",//课程ID &lt;/p&gt;
&lt;p&gt;"org_id" : "GUILIN",   //创建课程组织的ID&lt;/p&gt;
&lt;p&gt;"user_id" : 5,  //用户ID&lt;/p&gt;
&lt;p&gt;"path" : "/event"   //事件生成的地址&lt;/p&gt;
&lt;p&gt;}, 
&lt;/p&gt;
&lt;p&gt;"event_source" : "browser",      //定的源交互触发事件。这个字段的值是:‘browser’, 
                              ‘mobile’,‘server’,‘task’&lt;/p&gt;
&lt;p&gt;"name" : "play_video",        //触发事件的类型，取决于event_source&lt;/p&gt;
&lt;p&gt;"ip" : "202.193.64.32",        //触发事件用户的IP &lt;/p&gt;
&lt;p&gt;"agent" : "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:40.0) Gecko/20100101 &amp;gt;  Firefox/40.0",          //用户在代理浏览器上触发事件的字符串&lt;/p&gt;
&lt;p&gt;"event" : { "code" : "html5", "id" : "ae334aecc83d4ad3b825ef693afabed9", "currentTime" : 0 },                        //确定每个触发事件的细节。不同的成员字段提供了不同的事件&lt;/p&gt;
&lt;p&gt;"host" : "www.edx.com",         //网站域名&lt;/p&gt;
&lt;p&gt;"session" : "651232ce26e5183e321849dc54c00bdc",   //这一个32个字符的值是一个关键,识别用户的会话。所有浏览器事件和服务器注册事件包括会话的价值。其他服务器事件和移动事件不包括一个会话值。&lt;/p&gt;
&lt;p&gt;"referer" : "http://&lt;strong&gt;&lt;em&gt;*&lt;/em&gt;&lt;/strong&gt;*, //从HTTP URI引用页请求头字段。&lt;/p&gt;
&lt;p&gt;"load_date" : { "$date" : "2015-11-17T09:55:39.938+0800" }, &lt;/p&gt;
&lt;p&gt;"accept_language" : "zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3",`  //可接受的语言&lt;/p&gt;
&lt;p&gt;"time" : "2015-11-16T12:41:24.011849+00:00",     //事件释放的时间&lt;/p&gt;
&lt;p&gt;"course_id" : "course-v1:XXXX+XS100+2016_T1",    //课程ID&lt;/p&gt;
&lt;p&gt;"load_file" : "tracking.log-20151116-1447679821",&lt;/p&gt;
&lt;p&gt;"page" : &lt;/p&gt;
&lt;p&gt;"http://****,   //URL的页面的用户访问事件时发出。移动设备上的视频事件产生,识别视频组件的URL。&lt;/p&gt;
&lt;p&gt;"event_type" : "play_video"    //触发事件的类型，取决于event_source
 }&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;论坛数据&lt;/h3&gt;
&lt;p&gt;论坛里的用户&lt;code&gt;（mongo/cs_comments_service_development/users）&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;用户订阅帖子的关系&lt;code&gt;（mongo/cs_comments_service_development/subscriptions）&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;论坛里的帖子和评论&lt;code&gt;（mongo/cs_comments_service_development/contents）&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;如下为论坛里面的帖子的集合:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;{ 
"_id" : { "$oid" : "564a9a507f437b83aa000001" },     //唯一id,单调递增&lt;/p&gt;
&lt;p&gt;"votes" : {                                    //投票数&lt;/p&gt;
&lt;p&gt;"up" : [],     //支持&lt;/p&gt;
&lt;p&gt;"down" : [],   //不支持&lt;/p&gt;
&lt;p&gt;"up_count" : 0,   //支持的总数&lt;/p&gt;
&lt;p&gt;"down_count" : 0,   //反对的总数&lt;/p&gt;
&lt;p&gt;"count" : 0,     //总投票数&lt;/p&gt;
&lt;p&gt;"point" : 0 },   //网络投票数=up_count&lt;/p&gt;
&lt;p&gt;"visible" : true, &lt;/p&gt;
&lt;p&gt;"abuse_flaggers" : [], &lt;/p&gt;
&lt;p&gt;"historical_abuse_flaggers" : [],   //如果一个讨论的主持人从评论删除不好的评论，所有的用户ID从abuse_flaggers场取出然后写该组中。&lt;/p&gt;
&lt;p&gt;"thread_type" : "discussion",     //确定文章的类型为“问题”或“讨论”。&lt;/p&gt;
&lt;p&gt;"comment_count" : 0,             //评论回复在这个线程的数量。这包括所有的反应和回答,但不包括原始线程开始。&lt;/p&gt;
&lt;p&gt;"at_position_list" : [],        //不再使用。只在子评论(回复)按created_at时间戳排序。&lt;/p&gt;
&lt;p&gt;"title" : "测试",               //帖子的主题&lt;/p&gt;
&lt;p&gt;"body" : "大家好",               //帖子的内容&lt;/p&gt;
&lt;p&gt;"course_id" : "course-v1:XXX+XS100+2016_T1",      //相关课程ID
"commentable_id" : "d0091754161783ed381f30d45b58657bb1e3129f", &lt;/p&gt;
&lt;p&gt;"_type" : "CommentThread",   //值为CommentThread(帖子) 或 Comment （评论帖子），取决于对象的类型&lt;/p&gt;
&lt;p&gt;"anonymous" : false,                  //是否匿名不显示在用户界面上,但讨论课程的团队和团队成员可以看到作者的用户名。&lt;/p&gt;
&lt;p&gt;"closed" : false,                //如果这是真的,这个线程被论坛版主或管理员关闭。&lt;/p&gt;
&lt;p&gt;"author_id" : "5",                   //作者ID&lt;/p&gt;
&lt;p&gt;"author_username" : "XXX",           //作者名字&lt;/p&gt;
&lt;p&gt;"updated_at" : { "$date" : "2015-11-17T11:09:04.147+0800" },     //更新时间&lt;/p&gt;
&lt;p&gt;"created_at" : { "$date" : "2015-11-17T11:09:04.147+0800" },     //创建时间&lt;/p&gt;
&lt;p&gt;"last_activity_at" : { "$date" : "2015-11-17T11:09:04.148+0800" }   //指示有最后一次的参与该讨论(新文章、编辑等)的时间
}&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如下为 用户与帖子关系的集合
&lt;img alt="subscriptions1" src="http://7xofqa.com1.z0.glb.clouddn.com/subscriptions1.png" /&gt;&lt;/p&gt;
&lt;h3&gt;答题数据&lt;/h3&gt;
&lt;p&gt;学生答题记录（mysql edxapp库中&lt;code&gt;courseware_studentmodule&lt;/code&gt;），如下为&lt;code&gt;courseware_studentmodule&lt;/code&gt;表的信息。&lt;/p&gt;
&lt;p&gt;&lt;img alt="courseware_studentmodule" src="http://7xofqa.com1.z0.glb.clouddn.com/courseware_studentmodule.png" /&gt;&lt;/p&gt;</summary><category term="edx"></category></entry><entry><title>Dogwood and Brich 数据库对比</title><link href="http://liyouxi.github.io/edx_1.html" rel="alternate"></link><published>2016-04-07T00:00:00+08:00</published><author><name>Ups and Downs</name></author><id>tag:liyouxi.github.io,2016-04-07:edx_1.html</id><summary type="html">&lt;hr /&gt;
&lt;p&gt;针对edx平台的升级数据库迁移是重中之重，但往往有很多有些人忽视这方面的问题，导致平台升级出现各种坑。下面针对dogwood和brich两个版本的数据进行对比，希望能给折腾数据的小伙伴一点帮助：&lt;/p&gt;
&lt;h2&gt;Mysql 数据库对比&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;auth_user表last_login字段dogwood允许为空长度为6，brich不允许null长度为0。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;auth_userprofile表dogwood比brich多了两个字段:bio和profile_image_uploaded_at;
city字段dogwood为null,brich不为null。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;student_courseenrollment表created字段dogwood长度为6，brich长度为0。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;对比如下：&lt;/h3&gt;
&lt;p&gt;Brich_auth_user&lt;/p&gt;
&lt;p&gt;&lt;img alt="Brich_auth_user" src="http://7xofqa.com1.z0.glb.clouddn.com/Brich_auth_user.png" /&gt;&lt;/p&gt;
&lt;p&gt;Dogwood_auth_user&lt;/p&gt;
&lt;p&gt;&lt;img alt="Dogwood_auth_user" src="http://7xofqa.com1.z0.glb.clouddn.com/Dogwood_auth_user.png" /&gt;&lt;/p&gt;
&lt;p&gt;Brich_auth_userprofile&lt;/p&gt;
&lt;p&gt;&lt;img alt="Brich_auth_userprofile" src="http://7xofqa.com1.z0.glb.clouddn.com/Brich_auth_userprofile.png" /&gt;&lt;/p&gt;
&lt;p&gt;Dogwood_auth_userprofile&lt;/p&gt;
&lt;p&gt;&lt;img alt="Dogwood_auth_userprofile" src="http://7xofqa.com1.z0.glb.clouddn.com/Dogwood_auth_userprofile.png" /&gt;&lt;/p&gt;
&lt;p&gt;Brich_student_courseenrollmen&lt;/p&gt;
&lt;p&gt;&lt;img alt="Brich_student_courseenrollmen" src="http://7xofqa.com1.z0.glb.clouddn.com/Brich_student_courseenrollment.png" /&gt;&lt;/p&gt;
&lt;p&gt;Dogwood_student_courseenrollment&lt;/p&gt;
&lt;p&gt;&lt;img alt="Dogwood_student_courseenrollment" src="http://7xofqa.com1.z0.glb.clouddn.com/Dogwood_student_courseenrollment.png" /&gt;&lt;/p&gt;
&lt;h2&gt;Mongo数据对比&lt;/h2&gt;
&lt;p&gt;cs_comments_service_development数据库中contents表新版比老版多一个key:context,value:string,并且course_id规则不一样。&lt;/p&gt;
&lt;p&gt;Users表中default_sort_key的value不一样，Dogwood为data,Brich为votes。&lt;/p&gt;
&lt;p&gt;Brich_mongo:users&lt;/p&gt;
&lt;p&gt;&lt;img alt="Brich_mongo_users" src="http://7xofqa.com1.z0.glb.clouddn.com/Brich_mongo_users.png" /&gt;&lt;/p&gt;
&lt;p&gt;Dogwood_mongo:users&lt;/p&gt;
&lt;p&gt;&lt;img alt="Dogwood_mongo_users" src="http://7xofqa.com1.z0.glb.clouddn.com/Dogwood_mongo_users.png" /&gt;&lt;/p&gt;
&lt;p&gt;Brich:cs_comments_service_development&lt;/p&gt;
&lt;p&gt;&lt;img alt="Brich_cs_comments" src="http://7xofqa.com1.z0.glb.clouddn.com/Brich_cs_comments.png" /&gt;&lt;/p&gt;
&lt;p&gt;Dogwood:cs_comments_service_development&lt;/p&gt;
&lt;p&gt;&lt;img alt="Dogwood_cs_comments" src="http://7xofqa.com1.z0.glb.clouddn.com/Dogwood_cs_comments.png" /&gt;&lt;/p&gt;</summary><category term="edx"></category></entry></feed>